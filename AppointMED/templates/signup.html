<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Tailwind CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&family=Whisper&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="../static/css/style.css">
    <title>MedEasy - Sign Up</title>
</head>

<body class="bg-gray-100 h-screen">

    <div class="container mx-auto px-4 h-full">

        <!-- Navbar -->
        <div class="navbar mb-10">
            <a href="/">
                <img class="mx-auto my-8 w-32" src="../static/images/MedEasy.svg" alt="MedEasy logo">
            </a>
        </div>

        <div class="flex justify-center">
            <div class="bg-white w-full max-w-md rounded-lg shadow-md p-8">
                
                <!-- Sign Up Form -->
                <div id="signup-form">
                    <h2 class="font-semibold text-xl mb-6 text-center">Sign Up</h2>

                    <!-- Form Fields -->
                    <form method="post" action="/signup" class="space-y-6" enctype="multipart/form-data">

                        <!-- Account Type Selection -->
                        <div class="mb-6">
                            <span class="font-medium block mb-2">Account Type:</span>
                            <button type="button" id="patient-btn" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 mr-4" data-account-type="patient">Patient</button>
                            <button type="button" id="doctor-btn" class="bg-gray-300 text-black px-4 py-2 rounded hover:bg-gray-400" data-account-type="doctor">Doctor</button>
                            <input type="hidden" id="accountType" name="accountType" value="doctor">
                        </div>

                        <div>
                            <label for="signup-email" class="block mb-2 font-medium">Email:</label>
                            <input type="email" id="signup-email" name="email" required class="w-full p-2 border rounded">
                        </div>

                        <div class="relative">
                            <label for="signup-password" class="block mb-2 font-medium">Password:</label>
                            <input type="password" id="signup-password" name="password" required class="w-full p-2 border rounded">
                            <span toggle="#signup-password" class="material-icons toggle-password absolute top-1/2 right-3 cursor-pointer">visibility_off</span>
                        </div>

                            <div id="doctor-fields" style="display:none;">

                                <div class="input-group">
                                    <label for="first_name">First Name:</label>
                                    <input type="text" id="first_name" name="first_name" required>
                                </div>

                                <div class="input-group">
                                    <label for="last_name">Last Name:</label>
                                    <input type="text" id="last_name" name="last_name" required>
                                </div>
                                <!-- Specialties Dropdown -->
                                <div class="dropdown mb-4 relative">
                                    <label for="specialties" class="block mb-2 font-medium">Specialties:</label>
                                    <button class="w-full bg-gray-200 text-left px-4 py-2 rounded border focus:outline-none focus:ring" id="dropdownButtonSpecialties">
                                        Select Specialties
                                        <span class="material-icons absolute right-3 top transform -translate-y">keyboard_arrow_down</span>
                                    </button>
                                    <div class="dropdown-menu-specialties absolute w-full mt-2 hidden border rounded bg-white shadow-md z-10">
                                        <!-- ... Specialty checkbox options ... -->
                                        <label class="block px-4 py-2 hover:bg-gray-100 cursor-pointer">
                                            <input type="checkbox" name="specialties[]" value="Cardiologist" class="mr-2"> Cardiologist
                                        </label>
                                        <label class="block px-4 py-2 hover:bg-gray-100 cursor-pointer">
                                            <input type="checkbox" name="specialties[]" value="Dermatologist" class="mr-2"> Dermatologist
                                        </label>
                                        <label class="block px-4 py-2 hover:bg-gray-100 cursor-pointer">
                                            <input type="checkbox" name="specialties[]" value="Allergist" class="mr-2"> Allergist
                                        </label>
                                        <label class="block px-4 py-2 hover:bg-gray-100 cursor-pointer">
                                            <input type="checkbox" name="specialties[]" value="Generalist" class="mr-2"> Generalist
                                        </label>
                                        <label class="block px-4 py-2 hover:bg-gray-100 cursor-pointer">
                                            <input type="checkbox" name="specialties[]" value="Pediatrician" class="mr-2"> Pediatrician
                                        </label>
                                        <label class="block px-4 py-2 hover:bg-gray-100 cursor-pointer">
                                            <input type="checkbox" name="specialties[]" value="Orthopedist" class="mr-2"> Orthopedist
                                        </label>
                                        <label class="block px-4 py-2 hover:bg-gray-100 cursor-pointer">
                                            <input type="checkbox" name="specialties[]" value="Ophtalmologist" class="mr-2"> Ophtalmologist
                                        </label>
                                        <label class="block px-4 py-2 hover:bg-gray-100 cursor-pointer">
                                            <input type="checkbox" name="specialties[]" value="Radiologist" class="mr-2"> Radiologist
                                        </label>
                                            <!-- ... other options ... -->
                                    </div>
                                </div>
                                        
                                <div class="input-group">
                                    <label for="address">Address:</label>
                                    <input type="text" id="address" name="address" required>
                                </div>


                                <div class="dropdown mb-4 relative">
                                    <label for="medical_coverages" class="block mb-2 font-medium">Medical Coverages:</label>
                                    <button class="w-full bg-gray-200 text-left px-4 py-2 rounded border focus:outline-none focus:ring" id="dropdownButtonCoverages">
                                        Select Coverages
                                        <span class="material-icons absolute right-3 top transform -translate-y">keyboard_arrow_down</span>
                                    </button>
                                    <div class="dropdown-menu-coverages absolute w-full mt-2 hidden border rounded bg-white shadow-md z-10">
                                        <!-- ... Coverage checkbox options ... -->
                                        <label class="block px-4 py-2 hover:bg-gray-100 cursor-pointer"><input type="checkbox" name="medical_coverages[]" value="Triple S" class="mr-2"> Triple S</label>
                                        <label class="block px-4 py-2 hover:bg-gray-100 cursor-pointer"><input type="checkbox" name="medical_coverages[]" value="First Medical" class="mr-2"> First Medical</label>
                                        <label class="block px-4 py-2 hover:bg-gray-100 cursor-pointer"><input type="checkbox" name="medical_coverages[]" value="Humana" class="mr-2"> Humana</label>
                                        <label class="block px-4 py-2 hover:bg-gray-100 cursor-pointer"><input type="checkbox" name="medical_coverages[]" value="MCS" class="mr-2"> MCS</label>
                                        <!-- ... other options ... -->
                                    </div>
                                </div>
                    
                                <div class="input-group">
                                    <label for="phone_number">Phone Number:</label>
                                    <input type="tel" id="phone_number" name="phone_number" required>
                                </div>
                            
                                <div class="input-group">
                                    <label for="photo">Insert Photo:</label>
                                    <input type="file" id="photo" name="photo" accept="image/*">
                                    <img id="photo-preview" src="#" alt="Image Preview" style="display:none; max-width: 200px; margin-top: 10px;">
                                </div>
                        </div>

                        <!-- Patient Fields -->
                        <div id="patient-fields" style="display:none;">
                            <div class="input-group">
                                <label for="patient_first_name">First Name:</label>
                                <input type="text" id="patient_first_name" name="first_name" required>
                            </div>

                            <div class="input-group">
                                <label for="patient_last_name">Last Name:</label>
                                <input type="text" id="patient_last_name" name="last_name" required>
                            </div>

                            <div class="input-group">
                                <label for="patient_phone_number">Phone Number:</label>
                                <input type="tel" id="patient_phone_number" name="phone_number" required>
                            </div>
                        </div>


                        <!-- Create Account button -->
                        <div>
                            <input class="cursor-pointer w-full bg-blue-500 text-white p-2 rounded" type="submit" value="Create Account">
                        </div>

                        <div class="text-center mt-4">
                            <span>Already have an account? </span>
                            <a href="/signin" class="text-blue-500 hover:underline">Sign In</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
    // Check if coming from signin page and auto-select Patient button if true
    document.addEventListener("DOMContentLoaded", function() {
        const referrer = document.referrer;
        if (referrer && referrer.includes('/signin')) {
            document.getElementById('patient-btn').click();
        }
});

    // Account type switching using buttons
    document.getElementById('patient-btn').addEventListener('click', function() {
    // Add active styles to patient button
    this.classList.remove('bg-gray-300', 'text-black', 'hover:bg-gray-400');
    this.classList.add('bg-blue-500', 'text-white', 'hover:bg-blue-600');

    // Remove active styles from doctor button
    const doctorBtn = document.getElementById('doctor-btn');
    doctorBtn.classList.remove('bg-blue-500', 'text-white', 'hover:bg-blue-600');
    doctorBtn.classList.add('bg-gray-300', 'text-black', 'hover:bg-gray-400');

    // Set account type
    document.getElementById('accountType').value = 'patient';

    // Show patient fields and hide doctor fields
    document.getElementById('patient-fields').style.display = 'block';
    document.getElementById('doctor-fields').style.display = 'none';

    // Set required attributes for patient fields
    document.getElementById('patient_first_name').setAttribute('required', true);
    document.getElementById('patient_last_name').setAttribute('required', true);
    document.getElementById('patient_phone_number').setAttribute('required', true);
    
    // Remove required attributes for doctor fields
    document.getElementById('first_name').removeAttribute('required');
    document.getElementById('last_name').removeAttribute('required');
    document.getElementById('address').removeAttribute('required');
    document.getElementById('phone_number').removeAttribute('required');
});


    document.getElementById('doctor-btn').addEventListener('click', function() {
    // Add active styles to doctor button
    this.classList.remove('bg-gray-300', 'text-black', 'hover:bg-gray-400');
    this.classList.add('bg-blue-500', 'text-white', 'hover:bg-blue-600');

    // Remove active styles from patient button
    const patientBtn = document.getElementById('patient-btn');
    patientBtn.classList.remove('bg-blue-500', 'text-white', 'hover:bg-blue-600');
    patientBtn.classList.add('bg-gray-300', 'text-black', 'hover:bg-gray-400');

    // Set account type
    document.getElementById('accountType').value = 'doctor';

    // Show doctor fields and hide patient fields
    document.getElementById('doctor-fields').style.display = 'block';
    document.getElementById('patient-fields').style.display = 'none';

     // Set required attributes for doctor fields
    document.getElementById('first_name').setAttribute('required', true);
    document.getElementById('last_name').setAttribute('required', true);
    document.getElementById('address').setAttribute('required', true);
    document.getElementById('phone_number').setAttribute('required', true);

    // Remove required attributes for patient fields
    document.getElementById('patient_first_name').removeAttribute('required');
    document.getElementById('patient_last_name').removeAttribute('required');
    document.getElementById('patient_phone_number').removeAttribute('required');
});


    // Dropdown functionality for Specialties
    document.getElementById('dropdownButtonSpecialties').addEventListener('click', function() {
        const menu = document.querySelector('.dropdown-menu-specialties');
        const arrowIcon = this.querySelector('.material-icons');

        menu.classList.toggle('hidden');

        // Toggle arrow direction
        if (menu.classList.contains('hidden')) {
            arrowIcon.textContent = 'keyboard_arrow_down';
        } else {
            arrowIcon.textContent = 'keyboard_arrow_up';
        }
    });

    // Show selected items for Specialties
    document.querySelectorAll('.dropdown-menu-specialties input[type="checkbox"]').forEach(function(checkbox) {
        checkbox.addEventListener('change', function() {
            let selectedItems = [];
            document.querySelectorAll('.dropdown-menu-specialties input[type="checkbox"]:checked').forEach(function(checkedBox) {
                selectedItems.push(checkedBox.value);
            });
            const buttonText = selectedItems.length > 0 ? selectedItems.join(', ') : 'Select Specialties';
            document.getElementById('dropdownButtonSpecialties').firstChild.nodeValue = buttonText + " ";
        });
    });

    // Dropdown functionality for Medical Coverages
    document.getElementById('dropdownButtonCoverages').addEventListener('click', function() {
        const menu = document.querySelector('.dropdown-menu-coverages');
        const arrowIcon = this.querySelector('.material-icons');

        menu.classList.toggle('hidden');

        // Toggle arrow direction
        if (menu.classList.contains('hidden')) {
            arrowIcon.textContent = 'keyboard_arrow_down';
        } else {
            arrowIcon.textContent = 'keyboard_arrow_up';
        }
    });

    // Show selected items for Medical Coverages
    document.querySelectorAll('.dropdown-menu-coverages input[type="checkbox"]').forEach(function(checkbox) {
        checkbox.addEventListener('change', function() {
            let selectedItems = [];
            document.querySelectorAll('.dropdown-menu-coverages input[type="checkbox"]:checked').forEach(function(checkedBox) {
                selectedItems.push(checkedBox.value);
            });
            const buttonText = selectedItems.length > 0 ? selectedItems.join(', ') : 'Select Coverages';
            document.getElementById('dropdownButtonCoverages').firstChild.nodeValue = buttonText + " ";
        });
    });

    document.getElementById('photo').addEventListener('change', function() {
        const file = this.files[0];
        const reader = new FileReader();

        const maxSize = 5 * 1024 * 1024;  // 5MB
        
        if (file.size > maxSize) {
            alert('File size should be less than 5MB.');
            this.value = '';  // Clear the input
            return;
        }

        if (!file.type.match('image.*')) {
            alert('Please select a valid image.');
            this.value = '';  // Clear the input
            return;
        }

        reader.onloadend = function() {
            document.getElementById('photo-preview').src = reader.result;
            document.getElementById('photo-preview').style.display = 'block';
        }

        if (file) {
            reader.readAsDataURL(file);
        } else {
            document.getElementById('photo-preview').style.display = 'none';
        }
    });

    // Toggle visibility of password
    document.querySelector('.toggle-password').addEventListener('click', function(e) {
        // Get the icon and the input elements
        let icon = e.currentTarget;
        let input = document.querySelector(icon.getAttribute('toggle'));

        // Check the type of the input (password or text)
        if (input.type === "password") {
            input.type = "text";
            icon.textContent = 'visibility'; // Change the icon to 'visibility'
        } else {
            input.type = "password";
            icon.textContent = 'visibility_off'; // Change the icon to 'visibility_off'
        }
    });

    </script>


</body>

</html>
